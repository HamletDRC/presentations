if(!dojo.hostenv.findModule("xg.index.embed.badge",false)){
dojo.provide("xg.index.embed.badge");
xg.index.embed.badge={initialize:function(){
var _1=x$("div.xj_badge_body");
var _2=_1.attr("_embedCode");
_1.html(_2);
}};
xg.addOnRequire(function(){
xg.index.embed.badge.initialize();
});
}
if(!dojo.hostenv.findModule("xg.shared.EditUtil",false)){
dojo.provide("xg.shared.EditUtil");
xg.shared.EditUtil={showModuleForm:function(_1,_2,_3){
_1.style.height="0px";
dojo.html.show(_1);
dojo.lfx.html.wipeIn(_1,200).play();
},hideModuleForm:function(_4,_5,_6,_7){
dojo.html.removeClass(_6,"close");
dojo.lfx.html.wipeOut(_4,200,null,function(){
dojo.html.hide(_4);
if(_7){
_7();
}
}).play();
}};
}
if(!dojo.hostenv.findModule("xg.index.embed.BadgeModule",false)){
dojo.provide("xg.index.embed.BadgeModule");
dojo.widget.defineWidget("xg.index.embed.BadgeModule",dojo.widget.HtmlWidget,{_setValuesUrl:"",_badgeSizeSet:"",_badgeSizeOptionsJson:"",fillInTemplate:function(_1,_2){
this.module=this.getFragNodeRef(_2);
this.h2=this.module.getElementsByTagName("h2")[0];
dojo.dom.insertAfter(dojo.html.createNodesFromText("<p class=\"edit button\"><a class=\"button\" href=\"#\"><span>"+xg.index.nls.html("edit")+"</span></a></p>")[0],this.h2);
dojo.event.connect(this.module.getElementsByTagName("a")[0],"onclick",dojo.lang.hitch(this,function(_3){
dojo.event.browser.stopEvent(_3);
if((!this.form)||(this.form.style.height=="0px")){
this.showForm();
}else{
this.hideForm();
}
}));
},showForm:function(){
var _4=this.module.getElementsByTagName("a")[0];
var _5="";
dojo.lang.forEach(dj_eval(this._badgeSizeOptionsJson),function(_6){
_5+="<option value=\""+dojo.string.escape("html",_6.value)+"\">"+dojo.string.escape("html",_6.label)+"</option>";
});
if(!this.form){
this.form=xg.shared.util.createElement("                 <form class=\"xg_module_options\">                     <fieldset class=\"dy-form-2\">                         <dl>                             <dt><label for=\""+this.widgetId+"_badgeSize\">"+xg.index.nls.html("size")+"</label></dt>                             <dd>                                 <select id=\""+this.widgetId+"_badgeSize\">                                     "+_5+"                                 </select>                              </dd>                         </dl>                         <dl>                             <dt></dt>                             <dd><input type=\"submit\" value=\""+xg.index.nls.html("save")+"\" class=\"button action-primary submit\"/>                             <a class=\"action-secondary\"  id=\""+this.widgetId+"_cancelbtn\" href=\"#\">"+xg.index.nls.html("cancel")+"</a></dd>                         </dl>                     </fieldset>                 </form>                 ");
this.head=dojo.html.getElementsByClass("xg_module_head",this.module)[0];
dojo.dom.insertAfter(this.form,this.head);
this.formHeight=this.form.offsetHeight;
this.form.style.height="0px";
dojo.event.connect(this.form,"onsubmit",dojo.lang.hitch(this,function(_7){
this.save(_7);
}));
dojo.event.connect(dojo.byId(this.widgetId+"_cancelbtn"),"onclick",dojo.lang.hitch(this,function(_8){
dojo.event.browser.stopEvent(_8);
this.hideForm();
}));
}else{
dojo.html.removeClass(this.form,"collapsed");
}
this.form.style.height="0px";
xg.index.util.FormHelper.select(this._badgeSizeSet,dojo.byId(this.widgetId+"_badgeSize"));
xg.shared.EditUtil.showModuleForm(this.form,this.formHeight,_4);
},hideForm:function(){
var _9=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.hideModuleForm(this.form,this.formHeight,_9);
},save:function(_a){
dojo.event.browser.stopEvent(_a);
this._badgeSizeSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_badgeSize")).value;
this.hideForm();
dojo.io.bind({url:this._setValuesUrl,method:"post",content:{badgeSizeSet:this._badgeSizeSet},preventCache:true,mimetype:"text/javascript",encoding:"utf-8",load:dojo.lang.hitch(this,dojo.lang.hitch(this,function(_b,_c,_d){
dojo.lang.forEach(dojo.html.getElementsByClass("xg_module_body",this.module),function(_e){
dojo.dom.removeNode(_e);
});
x$(".xg_module_foot",this.module).before(dojo.html.createNodesFromText(_c.moduleBodyAndFooterHtml));
xg.shared.util.fixImagesInIE(this.module.getElementsByTagName("img"));
xg.shared.util.parseWidgets(dojo.html.getElementsByClass("xg_module_body",this.module)[0]);
if(!dojo.hostenv.findModule("xg.index.embed.badge",false)){
ning.loader.require("xg.index.embed.badge");
}else{
xg.index.embed.badge.initialize();
}
}))});
}});
}
if(!dojo.hostenv.findModule("xg.groups.embed.GroupModule",false)){
dojo.provide("xg.groups.embed.GroupModule");
dojo.widget.defineWidget("xg.groups.embed.GroupModule",dojo.widget.HtmlWidget,{_setValuesUrl:"",_updateEmbedUrl:"",_groupSet:"",_optionsJson:"",_itemCount:"",_itemCountArray:null,fillInTemplate:function(_1,_2){
this.module=this.getFragNodeRef(_2);
this.initializeItemCountArray();
this.h2=this.module.getElementsByTagName("h2")[0];
dojo.dom.insertAfter(dojo.html.createNodesFromText("<p class=\"edit\"><a class=\"button\" href=\"#\"><span>"+xg.groups.nls.html("edit")+"</span></a></p>")[0],this.h2);
dojo.event.connect(this.module.getElementsByTagName("a")[0],"onclick",dojo.lang.hitch(this,function(_3){
dojo.event.browser.stopEvent(_3);
if(!this.form||this.form.style.height=="0px"){
this.showForm();
}else{
this.hideForm();
}
}));
},initializeItemCountArray:function(){
this._itemCountArray={};
this._itemCountArray["0"]="0";
this._itemCountArray["1"]="1";
this._itemCountArray["2"]="2";
this._itemCountArray["3"]="3";
this._itemCountArray["5"]="5";
this._itemCountArray["10"]="10";
this._itemCountArray["15"]="15";
this._itemCountArray["20"]="20";
},showForm:function(){
var _4=this.module.getElementsByTagName("a")[0];
if(!this.form){
var _5=dojo.json.evalJson(this._optionsJson);
var _6="";
var _7="";
dojo.lang.forEach(_5,function(_8){
_6+="<option value=\""+dojo.string.escape("html",_8.value)+"\">"+dojo.string.escape("html",_8.label)+"</option>";
});
x$.each(this._itemCountArray,function(_9,_a){
_7+="<option value=\""+dojo.string.escape("html",""+_9)+"\">"+dojo.string.escape("html",""+_a)+"</option>";
});
this.form=dojo.html.createNodesFromText(dojo.string.trim("                 <form class=\"xg_module_options\">                     <fieldset class=\"dy-form-2\">                         <dl  class=\"setting_select\">                            <dt "+(_5.length>1?"":"style=\"display:none\"")+"><label for=\""+this.widgetId+"_select\">"+xg.groups.nls.html("from")+"</label></dt>                            <dd "+(_5.length>1?"":"style=\"display:none\"")+">                                <select id=\""+this.widgetId+"_select\">                                     "+_6+"                                 </select>                             </dd>                        </dl>                        <dl  class=\"setting_item_count\">                            <dt><label for=\""+this.widgetId+"_item_count\">"+xg.groups.nls.html("show")+"</label></dt>                            <dd>                                <select id=\""+this.widgetId+"_item_count\" class=\"short\">                                     "+_7+"                                 </select> "+xg.groups.nls.html("groups")+"                            </dd>                        </dl>                        <dl>                            <dt></dt>                             <dd><input type=\"submit\" value=\""+xg.groups.nls.html("save")+"\" class=\"button action-primary\"/>                             <a class=\"action-secondary\"  id=\""+this.widgetId+"_cancelbtn\" href=\"#\">"+xg.groups.nls.html("cancel")+"</a> </dd>                        </dl>                    </fieldset>                 </form>             "))[0];
this.head=dojo.html.getElementsByClass("xg_module_head",this.module)[0];
dojo.dom.insertAfter(this.form,this.head);
this.formHeight=this.form.offsetHeight;
this.form.style.height="0px";
dojo.event.connect(this.form,"onsubmit",dojo.lang.hitch(this,function(_b){
this.save(_b);
}));
dojo.event.connect(dojo.byId(this.widgetId+"_cancelbtn"),"onclick",dojo.lang.hitch(this,function(_c){
this.cancel(_c);
}));
}
xg.index.util.FormHelper.select(this._groupSet,dojo.byId(this.widgetId+"_select"));
if(!xg.index.util.FormHelper.select(this._itemCount,dojo.byId(this.widgetId+"_item_count"))){
xg.index.util.FormHelper.select("5",dojo.byId(this.widgetId+"_item_count"));
}
xg.shared.EditUtil.showModuleForm(this.form,this.formHeight,_4);
},hideForm:function(){
var _d=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.hideModuleForm(this.form,this.formHeight,_d);
},updateEmbed:function(ui){
var _f=this.module.parentNode.getAttribute("_columncount");
dojo.io.bind({url:this._updateEmbedUrl,method:"post",content:{columnCount:_f},preventCache:true,mimetype:"text/json",encoding:"utf-8",load:dojo.lang.hitch(this,dojo.lang.hitch(this,function(_10,_11,_12){
dojo.lang.forEach(dojo.html.getElementsByClass("xg_module_body",this.module),function(_13){
dojo.dom.removeNode(_13);
});
var _14=dojo.html.getElementsByClass("xg_module_foot",this.module)[0];
if(_14){
dojo.dom.removeNode(_14);
}
dojo.lang.forEach(dojo.html.createNodesFromText(_11.moduleBodyAndFooterHtml),dojo.lang.hitch(this,function(_15){
dojo.dom.insertAtPosition(_15,this.module,"last");
}));
xg.shared.util.fixImagesInIE(this.module.getElementsByTagName("img"));
ui.item.css("visibility","");
}))});
},save:function(_16){
dojo.event.browser.stopEvent(_16);
var _17=this.module.parentNode.getAttribute("_columncount");
this._groupSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_select")).value;
this._itemCount=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_item_count")).value;
this.hideForm();
dojo.io.bind({url:this._setValuesUrl,method:"post",content:{groupSet:this._groupSet,itemCount:this._itemCount,columnCount:_17},preventCache:true,mimetype:"text/javascript",encoding:"utf-8",load:dojo.lang.hitch(this,dojo.lang.hitch(this,function(_18,_19,_1a){
dojo.lang.forEach(dojo.html.getElementsByClass("xg_module_body",this.module),function(_1b){
dojo.dom.removeNode(_1b);
});
var _1c=dojo.html.getElementsByClass("xg_module_foot",this.module)[0];
if(_1c){
dojo.dom.removeNode(_1c);
}
dojo.lang.forEach(dojo.html.createNodesFromText(_19.moduleBodyAndFooterHtml),dojo.lang.hitch(this,function(_1d){
dojo.dom.insertAtPosition(_1d,this.module,"last");
}));
xg.shared.util.fixImagesInIE(this.module.getElementsByTagName("img"));
}))});
},cancel:function(_1e){
dojo.event.browser.stopEvent(_1e);
this.hideForm();
}});
}
if(!dojo.hostenv.findModule("xg.profiles.embed.MembersModule",false)){
dojo.provide("xg.profiles.embed.MembersModule");
dojo.widget.defineWidget("xg.profiles.embed.MembersModule",dojo.widget.HtmlWidget,{_setValuesUrl:"",_displaySet:"",_displayOptionsJson:"",_sortSet:"",_sortOptionsJson:"",_rowsSet:"",_rowsOptionsJson:"",isContainer:true,fillInTemplate:function(_1,_2){
this.module=this.getFragNodeRef(_2);
this.h2=this.module.getElementsByTagName("h2")[0];
dojo.dom.insertAfter(dojo.html.createNodesFromText("<p class=\"edit button\"><a class=\"button\" href=\"#\"><span>"+xg.profiles.nls.html("edit")+"</span></a></p>")[0],this.h2);
dojo.event.connect(this.module.getElementsByTagName("a")[0],"onclick",dojo.lang.hitch(this,function(_3){
dojo.event.browser.stopEvent(_3);
if((!this.form)||(this.form.style.height=="0px")){
this.showForm();
}else{
this.hideForm();
}
}));
},showForm:function(){
var _4=this.module.getElementsByTagName("a")[0];
var _5="";
dojo.lang.forEach(dj_eval(this._displayOptionsJson),function(_6){
_5+="<option value=\""+dojo.string.escape("html",_6.value)+"\">"+dojo.string.escape("html",_6.label)+"</option>";
});
var _7="";
dojo.lang.forEach(dj_eval(this._sortOptionsJson),function(_8){
_7+="<option value=\""+dojo.string.escape("html",_8.value)+"\">"+dojo.string.escape("html",_8.label)+"</option>";
});
var _9="";
dojo.lang.forEach(dj_eval(this._rowsOptionsJson),function(_a){
_9+="<option value=\""+dojo.string.escape("html",_a.value)+"\">"+dojo.string.escape("html",_a.label)+"</option>";
});
if(!this.form){
this.form=dojo.html.createNodesFromText(dojo.string.trim("                 <form class=\"xg_module_options\">                     <fieldset class=\"dy-form-2\">                         <dl  class=\"setting_display\">                             <dt><label for=\""+this.widgetId+"_display\">"+xg.profiles.nls.html("display")+"</label></dt>                             <dd>                                 <select id=\""+this.widgetId+"_display\">                                     "+_5+"                                 </select>                             </dd>                         </dl>                         <dl  class=\"setting_sort\">                             <dt><label for=\""+this.widgetId+"_sort\">"+xg.profiles.nls.html("from")+"</label></dt>                             <dd>                                 <select id=\""+this.widgetId+"_sort\">                                     "+_7+"                                 </select>                             </dd>                         </dl>                         <dl  class=\"setting_rows\">                             <dt><label for=\""+this.widgetId+"_rows\">"+xg.profiles.nls.html("show")+"</label></dt>                             <dd>                                 <select id=\""+this.widgetId+"_rows\" class=\"short\">                                     "+_9+"                                 </select> "+xg.profiles.nls.html("rows")+"                            </dd>                         </dl>                         <dl>                             <dt></dt>                             <dd><input type=\"submit\" value=\""+xg.profiles.nls.html("save")+"\" class=\"button action-primary submit\"/>                             <a class=\"action-secondary\"  id=\""+this.widgetId+"_cancelbtn\" href=\"#\">"+xg.profiles.nls.html("cancel")+"</a></dd>                         </dl>                     </fieldset>                 </form>                 "))[0];
this.head=dojo.html.getElementsByClass("xg_module_head",this.module)[0];
dojo.dom.insertAfter(this.form,this.head);
this.formHeight=this.form.offsetHeight;
this.form.style.height="0px";
dojo.event.connect(this.form,"onsubmit",dojo.lang.hitch(this,function(_b){
this.save(_b);
}));
dojo.event.connect(dojo.byId(this.widgetId+"_cancelbtn"),"onclick",dojo.lang.hitch(this,function(_c){
dojo.event.browser.stopEvent(_c);
this.hideForm();
}));
}else{
dojo.html.removeClass(this.form,"collapsed");
}
this.form.style.height="0px";
xg.index.util.FormHelper.select(this._displaySet,dojo.byId(this.widgetId+"_display"));
xg.index.util.FormHelper.select(this._sortSet,dojo.byId(this.widgetId+"_sort"));
xg.index.util.FormHelper.select(this._rowsSet,dojo.byId(this.widgetId+"_rows"));
xg.shared.EditUtil.showModuleForm(this.form,this.formHeight,_4);
},hideForm:function(){
var _d=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.hideModuleForm(this.form,this.formHeight,_d);
},save:function(_e){
dojo.event.browser.stopEvent(_e);
this._displaySet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_display")).value;
this._sortSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_sort")).value;
this._rowsSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_rows")).value;
this.hideForm();
dojo.io.bind({url:this._setValuesUrl,method:"post",content:{displaySet:this._displaySet,sortSet:this._sortSet,rowsSet:this._rowsSet},preventCache:true,mimetype:"text/javascript",encoding:"utf-8",load:dojo.lang.hitch(this,dojo.lang.hitch(this,function(_f,_10,_11){
dojo.lang.forEach(dojo.html.getElementsByClass("xg_module_body",this.module),function(_12){
dojo.dom.removeNode(_12);
});
var _13=dojo.html.getElementsByClass("xg_module_foot",this.module)[0];
if(_13){
dojo.dom.removeNode(_13);
}
dojo.lang.forEach(dojo.html.createNodesFromText(_10.moduleBodyAndFooterHtml),dojo.lang.hitch(this,function(_14){
dojo.dom.insertAtPosition(_14,this.module,"last");
}));
xg.shared.util.fixImagesInIE(this.module.getElementsByTagName("img"));
xg.shared.util.parseWidgets(dojo.html.getElementsByClass("xg_module_body",this.module)[0]);
}))});
}});
}
if(!dojo.hostenv.findModule("xg.profiles.embed.blog",false)){
dojo.provide("xg.profiles.embed.blog");
dojo.provide("xg.profiles.embed.blog.BlogModule");
dojo.widget.defineWidget("xg.profiles.embed.blog.BlogModule",dojo.widget.HtmlWidget,{_url:"",_updateUrl:"",_layoutType:"<required>",_displaySet:"",_displayOptionsJson:"",_excerptLengthOptionsJson:"",_excerptLengthSet:"",_sortSet:"",_sortOptionsJson:"",_postsSet:"",_postsTitleOptionsJson:"",_postsDetailOptionsJson:"",postsTitleOptionsHtml:"",postsDetailOptionsHtml:"",fillInTemplate:function(_1,_2){
this.module=this.getFragNodeRef(_2);
this.h2=this.module.getElementsByTagName("h2")[0];
dojo.dom.insertAfter(dojo.html.createNodesFromText("<p class=\"edit\"><a class=\"button\" href=\"#\"><span>"+xg.profiles.nls.html("edit")+"</span></a></p>")[0],this.h2);
var _3=dj_eval(this._postsTitleOptionsJson);
var _4=dj_eval(this._postsDetailOptionsJson);
var _5="";
dojo.lang.forEach(_3,function(_6){
_5+="<option value=\""+dojo.string.escape("html",_6.value)+"\">"+dojo.string.escape("html",_6.label)+"</option>";
});
var _7="";
dojo.lang.forEach(_4,function(_8){
_7+="<option value=\""+dojo.string.escape("html",_8.value)+"\">"+dojo.string.escape("html",_8.label)+"</option>";
});
this.postsTitleOptionsHtml=_5;
this.postsDetailOptionsHtml=_7;
dojo.event.connect(this.module.getElementsByTagName("a")[0],"onclick",dojo.lang.hitch(this,function(_9){
dojo.event.browser.stopEvent(_9);
if((!this.form)||(this.form.style.height=="0px")){
this.showForm();
}else{
this.hideForm();
}
}));
},showForm:function(){
var _a=this.module.getElementsByTagName("a")[0];
this.head=dojo.html.getElementsByClass("xg_module_head",this.module)[0];
this.body=dojo.html.getElementsByClass("xg_module_body",this.module)[0];
this.foot=dojo.html.getElementsByClass("xg_module_foot",this.module)[0];
if(!this.form){
var _b="";
dojo.lang.forEach(dj_eval(this._displayOptionsJson),function(_c){
_b+="<option value=\""+dojo.string.escape("html",_c.value)+"\">"+dojo.string.escape("html",_c.label)+"</option>";
});
if(this._sortOptionsJson){
var _d="";
dojo.lang.forEach(dj_eval(this._sortOptionsJson),function(_e){
_d+="<option value=\""+dojo.string.escape("html",_e.value)+"\">"+dojo.string.escape("html",_e.label)+"</option>";
});
}
var _f="";
if(this._excerptLengthOptionsJson){
var _10=dj_eval(this._excerptLengthOptionsJson);
for(var _11=0;_11<_10.length;_11++){
_f+="<option value=\""+_10[_11]+"\">"+_10[_11]+"</option>";
}
}
this.form=dojo.html.createNodesFromText(dojo.string.trim("             <form class=\"xg_module_options\">                 <fieldset class=\"dy-form-2\">                     <dl class=\"setting_display\">                        <dt><label for=\""+this.widgetId+"_display\">"+xg.profiles.nls.html("display")+"</label></dt>                        <dd>                             <select id=\""+this.widgetId+"_display\">                                 "+_b+"                             </select>                         </dd>                     </dl>                     <dl class=\"setting_sort\">                         "+(this._sortOptionsJson?"                        <dt><label for=\""+this.widgetId+"_sort\">"+xg.profiles.nls.html("from")+"</label></dt>                        <dd>                             <select id=\""+this.widgetId+"_sort\">                                 "+_d+"                             </select>                         </dd>":"")+"                    </dl>                     <dl class=\"setting_posts\">                         <dt><label for=\""+this.widgetId+"_posts\">"+xg.profiles.nls.html("show")+"</label></dt>                         <dd>                             <select id=\""+this.widgetId+"_posts\" class=\"short\">                             </select> "+xg.profiles.nls.html("posts")+"                        </dd>                     </dl>                    <dl class=\"setting_excerptLength\">                        <dt class=\"excerptItem\"><label for=\""+this.widgetId+"_excerptLength\">"+xg.profiles.nls.html("show")+"</label></dt>                         <dd class=\"excerptItem\">                                <select id=\""+this.widgetId+"_excerptLength\">                            "+_f+"                            </select>                            "+xg.profiles.nls.html("htmlCharacters")+"                        </dd>                    </dl>                    <dl>                         <dt></dt>                         <dd><input type=\"submit\" value=\""+xg.profiles.nls.html("save")+"\" class=\"button action-primary\" />                         <a class=\"action-secondary\"  id=\""+this.widgetId+"_cancelbtn\" href=\"#\">"+xg.profiles.nls.html("cancel")+"</a></dd>                     </dl>                 </fieldset>             </form>             "))[0];
dojo.dom.insertAfter(this.form,this.head);
this.formHeight=this.form.offsetHeight;
this.form.style.height="0px";
dojo.event.connect(this.form,"onsubmit",dojo.lang.hitch(this,function(_12){
this.save(_12);
}));
dojo.event.connect(dojo.byId(this.widgetId+"_cancelbtn"),"onclick",dojo.lang.hitch(this,function(_13){
dojo.event.browser.stopEvent(_13);
this.hideForm();
}));
}else{
dojo.html.removeClass(this.form,"collapsed");
}
this.form.style.height=0;
xg.index.util.FormHelper.select(this._displaySet,dojo.byId(this.widgetId+"_display"));
if(this._sortOptionsJson){
xg.index.util.FormHelper.select(this._sortSet,dojo.byId(this.widgetId+"_sort"));
}
xg.index.util.FormHelper.select(this._excerptLengthSet,dojo.byId(this.widgetId+"_excerptLength"));
this.updateFieldDisplay();
var _14=this;
x$("#"+this.widgetId+"_display").change(function(){
_14.updateFieldDisplay(true);
});
xg.shared.EditUtil.showModuleForm(this.form,this.formHeight,_a);
},updateFieldDisplay:function(_15){
if(dojo.byId(this.widgetId+"_display").value=="detail"){
x$("#"+this.widgetId+"_posts").html(this.postsDetailOptionsHtml);
if(_15||!xg.index.util.FormHelper.select(this._postsSet,dojo.byId(this.widgetId+"_posts"))){
xg.index.util.FormHelper.select("4",dojo.byId(this.widgetId+"_posts"));
}
x$(".excerptItem",this.form).show();
}else{
x$("#"+this.widgetId+"_posts").html(this.postsTitleOptionsHtml);
if(_15||!xg.index.util.FormHelper.select(this._postsSet,dojo.byId(this.widgetId+"_posts"))){
xg.index.util.FormHelper.select("5",dojo.byId(this.widgetId+"_posts"));
}
x$(".excerptItem",this.form).hide();
}
},hideForm:function(){
var _16=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.hideModuleForm(this.form,this.formHeight,_16);
},updateEmbed:function(ui){
var _18=this.module.parentNode.getAttribute("_maxembedwidth");
dojo.io.bind({url:this._updateUrl,method:"post",encoding:"utf-8",mimetype:"text/json",preventCache:true,content:{maxEmbedWidth:_18},load:dojo.lang.hitch(this,function(_19,_1a,_1b){
this.module.getElementsByTagName("h2")[0].innerHTML=dojo.string.escape("html",_1a.embedTitle);
dojo.html.getElementsByClass("xg_module_body",this.module)[0].innerHTML=_1a.moduleBodyHtml;
ui.item.css("visibility","");
var _1c=this.module.getElementsByTagName("div")[0];
if(dojo.html.hasClass(_1c,"xg_handle")){
dojo.style.hide(_1c);
}
})});
},save:function(_1d){
dojo.event.browser.stopEvent(_1d);
var _1e=this.module.parentNode.getAttribute("_maxembedwidth");
this._displaySet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_display")).value;
if(this._sortOptionsJson){
this._sortSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_sort")).value;
}
this._postsSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_posts")).value;
if(this._excerptLengthOptionsJson){
this._excerptLengthSet=x$("#"+this.widgetId+"_excerptLength").val();
}
if("undefined"!=typeof this.body){
this.body.innerHTML=xg.profiles.nls.html("loading");
}else{
x$(this.foot).before("<div class=\"xg_module_body xj_loading_msg\">"+xg.profiles.nls.html("loading")+"</div>");
}
this.hideForm();
dojo.io.bind({url:this._url,method:"post",preventCache:true,encoding:"utf-8",mimetype:"text/javascript",content:{displaySet:this._displaySet,sortSet:this._sortSet,postsSet:this._postsSet,excerptLengthSet:this._excerptLengthSet,maxEmbedWidth:_1e},load:dojo.lang.hitch(this,function(_1f,_20,_21){
this.h2.innerHTML=dojo.string.escape("html",_20.embedTitle);
var _22="undefined"!=typeof this.body;
var _23=_22?x$(this.body).prev()[0]:x$(this.head).next()[0];
if(_22){
x$(this.body).remove();
}else{
x$(".xj_loading_msg").remove();
}
x$(this.foot).remove();
x$(_23).after(_20.moduleBodyHtml);
xg.shared.util.parseWidgets(x$(_23).next()[0]);
})});
}});
}
if(!dojo.hostenv.findModule("xg.profiles.embed.BirthdaysModule",false)){
dojo.provide("xg.profiles.embed.BirthdaysModule");
dojo.widget.defineWidget("xg.profiles.embed.BirthdaysModule",dojo.widget.HtmlWidget,{_setValuesUrl:"",_itemCountSet:"",_itemCountOptionsJson:"",fillInTemplate:function(_1,_2){
this.module=this.getFragNodeRef(_2);
this.h2=this.module.getElementsByTagName("h2")[0];
dojo.dom.insertAfter(dojo.html.createNodesFromText("<p class=\"edit button\"><a class=\"button\" href=\"#\"><span>"+xg.profiles.nls.html("edit")+"</span></a></p>")[0],this.h2);
dojo.event.connect(this.module.getElementsByTagName("a")[0],"onclick",dojo.lang.hitch(this,function(_3){
dojo.event.browser.stopEvent(_3);
if((!this.form)||(this.form.style.height=="0px")){
this.showForm();
}else{
this.hideForm();
}
}));
},showForm:function(){
var _4=this.module.getElementsByTagName("a")[0];
var _5="";
dojo.lang.forEach(dj_eval(this._itemCountOptionsJson),function(_6){
_5+="<option value=\""+dojo.string.escape("html",_6.value)+"\">"+dojo.string.escape("html",_6.label)+"</option>";
});
if(!this.form){
this.form=xg.shared.util.createElement("                 <form class=\"xg_module_options\">                     <fieldset class=\"dy-form-2\">                         <dl  class=\"setting_itemCount\">                             <dt><label for=\""+this.widgetId+"_itemCount\">"+xg.profiles.nls.html("show")+"</label></dt>                             <dd>                                 <select id=\""+this.widgetId+"_itemCount\">                                     "+_5+"                                 </select> "+xg.profiles.nls.html("birthdays")+"                             </dd>                         </dl>                         <dl>                             <dt></dt>                             <dd><input type=\"submit\" value=\""+xg.profiles.nls.html("save")+"\" class=\"button action-primary submit\"/>                             <a class=\"action-secondary\"  id=\""+this.widgetId+"_cancelbtn\" href=\"#\">"+xg.profiles.nls.html("cancel")+"</a></dd>                         </dl>                     </fieldset>                 </form>                 ");
this.head=dojo.html.getElementsByClass("xg_module_head",this.module)[0];
dojo.dom.insertAfter(this.form,this.head);
this.formHeight=this.form.offsetHeight;
this.form.style.height="0px";
dojo.event.connect(this.form,"onsubmit",dojo.lang.hitch(this,function(_7){
this.save(_7);
}));
dojo.event.connect(dojo.byId(this.widgetId+"_cancelbtn"),"onclick",dojo.lang.hitch(this,function(_8){
dojo.event.browser.stopEvent(_8);
this.hideForm();
}));
}else{
dojo.html.removeClass(this.form,"collapsed");
}
this.form.style.height="0px";
xg.index.util.FormHelper.select(this._itemCountSet,dojo.byId(this.widgetId+"_itemCount"));
xg.shared.EditUtil.showModuleForm(this.form,this.formHeight,_4);
},hideForm:function(){
var _9=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.hideModuleForm(this.form,this.formHeight,_9);
},save:function(_a){
dojo.event.browser.stopEvent(_a);
this._itemCountSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_itemCount")).value;
this.hideForm();
dojo.io.bind({url:this._setValuesUrl,method:"post",content:{itemCountSet:this._itemCountSet},preventCache:true,mimetype:"text/javascript",encoding:"utf-8",load:dojo.lang.hitch(this,dojo.lang.hitch(this,function(_b,_c,_d){
dojo.lang.forEach(dojo.html.getElementsByClass("xg_module_body",this.module),function(_e){
dojo.dom.removeNode(_e);
});
dojo.lang.forEach(dojo.html.createNodesFromText(_c.moduleBodyAndFooterHtml),dojo.lang.hitch(this,function(_f){
dojo.dom.insertAtPosition(_f,this.module,"last");
}));
xg.shared.util.fixImagesInIE(this.module.getElementsByTagName("img"));
xg.shared.util.parseWidgets(dojo.html.getElementsByClass("xg_module_body",this.module)[0]);
}))});
}});
}
if(!dojo.hostenv.findModule("xg.forum.embed.ForumModule",false)){
dojo.provide("xg.forum.embed.ForumModule");
dojo.widget.defineWidget("xg.forum.embed.ForumModule",dojo.widget.HtmlWidget,{_categoriesEnabled:"",_viewOptionsJson:"",_viewSet:"",_setValuesUrl:"",_newTopicUrl:"",_topicSet:"",_numTitleOptionsJson:"",_numDetailOptionsJson:"",numTitleOptionsHtml:"",numDetailOptionsHtml:"",_displayOptionsJson:"",_displaySet:"",_optionsJson:"",_itemCount:"",_excerptLengthOptionsJson:"",_excerptLengthSet:"",_inGroupContext:false,fillInTemplate:function(_1,_2){
this.module=this.getFragNodeRef(_2);
this.h2=this.module.getElementsByTagName("h2")[0];
dojo.dom.insertAfter(dojo.html.createNodesFromText("<p class=\"edit\"><a class=\"button\" href=\"#\"><span>"+xg.forum.nls.html("edit")+"</span></a></p>")[0],this.h2);
var _3=dj_eval(this._numTitleOptionsJson);
var _4=dj_eval(this._numDetailOptionsJson);
var _5="";
dojo.lang.forEach(_3,function(_6){
_5+="<option value=\""+dojo.string.escape("html",_6.value)+"\">"+dojo.string.escape("html",_6.label)+"</option>";
});
var _7="";
dojo.lang.forEach(_4,function(_8){
_7+="<option value=\""+dojo.string.escape("html",_8.value)+"\">"+dojo.string.escape("html",_8.label)+"</option>";
});
this.numTitleOptionsHtml=_5;
this.numDetailOptionsHtml=_7;
dojo.event.connect(this.module.getElementsByTagName("a")[0],"onclick",dojo.lang.hitch(this,function(_9){
dojo.event.browser.stopEvent(_9);
if((!this.form)||(this.form.style.height=="0px")){
this.showForm();
}else{
this.hideForm();
}
}));
},showForm:function(){
if(!this.form){
var _a=dj_eval(this._displayOptionsJson);
var _b=dj_eval(this._optionsJson);
var _c=dojo.lang.filter(_b,function(_d){
return !_d.value.match(/category_/);
});
var _e=dojo.lang.filter(_b,function(_f){
return _f.value.match(/category_/);
});
var _10=dj_eval(this._viewOptionsJson);
var _11="";
dojo.lang.forEach(_10,function(_12){
_11+="<option value=\""+dojo.string.escape("html",_12.value)+"\">"+dojo.string.escape("html",_12.label)+"</option>";
});
var _13="";
dojo.lang.forEach(_a,function(_14){
_13+="<option value=\""+dojo.string.escape("html",_14.value)+"\">"+dojo.string.escape("html",_14.label)+"</option>";
});
var _15="";
dojo.lang.forEach(_c,function(_16){
_15+="<option value=\""+dojo.string.escape("html",_16.value)+"\">"+dojo.string.escape("html",_16.label)+"</option>";
});
var _17="";
if(this._excerptLengthOptionsJson){
var _18=dj_eval(this._excerptLengthOptionsJson);
for(var _19=0;_19<_18.length;_19++){
_17+="<option value=\""+_18[_19]+"\">"+_18[_19]+"</option>";
}
}
if(!this._inGroupContext&&_e.length){
_15+="<optgroup label=\""+xg.forum.nls.html("discussionsFromACategory")+"\">";
dojo.lang.forEach(_e,function(_1a){
_15+="<option value=\""+dojo.string.escape("html",_1a.value)+"\">"+dojo.string.escape("html",_1a.label)+"</option>";
});
_15+="</optgroup>";
}
this.form=dojo.html.createNodesFromText(dojo.string.trim("                 <form class=\"xg_module_options\">                     <fieldset class=\"dy-form-2\">                         <div id=\"embedviewOptions\">                             <dl class=\"setting_view\">                                <dt><label for=\""+this.widgetId+"_view\">"+xg.forum.nls.html("view")+"</label></dt>                                <dd>                                    <select id=\""+this.widgetId+"_view\">                                         "+_11+"                                    </select>                                 </dd>                            </dl>                        </div>                         <div id=\"embedDiscussionOptions\">                             <dl class=\"setting_display\">                                 <dt><label for=\""+this.widgetId+"_display\">"+xg.forum.nls.html("display")+"</label></dt>                                <dd>                                    <select id=\""+this.widgetId+"_display\">                                         "+_13+"                                    </select>                                 </dd>                            </dl>                             <dl class=\"setting_select\">                                 <dt><label for=\""+this.widgetId+"_select\">"+xg.forum.nls.html("from")+"</label></dt>                                <dd>                                    <select id=\""+this.widgetId+"_select\">                                         "+_15+"                                     </select>                                 </dd>                            </dl>                         </div>                         <dl class=\"setting_item_count\">                             <dt><label for=\""+this.widgetId+"_item_count\">"+xg.forum.nls.html("show")+"</label></dt>                            <dd>                                <select id=\""+this.widgetId+"_item_count\" class=\"short\">                                 </select> "+xg.forum.nls.html("items")+"                            </dd>                        <dl class=\"setting_excerptLength\">                             <dt class=\"excerptItem\"><label for=\""+this.widgetId+"_excerptLength\">"+xg.forum.nls.html("show")+"</label></dt>                             <dd class=\"excerptItem\">                                     <select id=\""+this.widgetId+"_excerptLength\">                                  "+_17+"                                   </select>                                "+xg.forum.nls.html("htmlCharacters")+"                            </dd>                        </dl>                        <dl>                          <dd>                            <input type=\"submit\" value=\""+xg.forum.nls.html("save")+"\" class=\"button action-primary\"/>                             <a class=\"action-secondary\"  id=\""+this.widgetId+"_cancelbtn\" href=\"#\">"+xg.forum.nls.html("cancel")+"</a>                           </dd>                        </dl>                    </fieldset>                 </form>                 "))[0];
this.head=dojo.html.getElementsByClass("xg_module_head",this.module)[0];
dojo.dom.insertAfter(this.form,this.head);
if(this._categoriesEnabled!="1"){
dojo.style.hide(dojo.byId("embedviewOptions"));
}
this.formHeight=this.form.offsetHeight;
this.form.style.height="0px";
dojo.event.connect(this.form,"onsubmit",dojo.lang.hitch(this,function(_1b){
this.save(_1b);
}));
dojo.event.connect(dojo.byId(this.widgetId+"_cancelbtn"),"onclick",dojo.lang.hitch(this,function(_1c){
dojo.event.browser.stopEvent(_1c);
this.hideForm();
}));
dojo.event.connect(dojo.byId(this.widgetId+"_view"),"onchange",dojo.lang.hitch(this,function(_1d){
this.toggleForumRelated(xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_view")).value=="categories");
}));
}else{
dojo.html.removeClass(this.form,"collapsed");
}
this.form.style.height="0px";
xg.index.util.FormHelper.select(this._viewSet,dojo.byId(this.widgetId+"_view"));
xg.index.util.FormHelper.select(this._displaySet,dojo.byId(this.widgetId+"_display"));
xg.index.util.FormHelper.select(this._topicSet,dojo.byId(this.widgetId+"_select"));
xg.index.util.FormHelper.select(this._excerptLengthSet,dojo.byId(this.widgetId+"_excerptLength"));
this.updateFieldDisplay();
var _1e=this;
x$("#"+this.widgetId+"_display").change(function(){
_1e.updateFieldDisplay(true);
});
if(this._categoriesEnabled=="1"&&this._viewSet=="categories"){
this.toggleForumRelated(true);
}
var _1f=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.showModuleForm(this.form,this.formHeight,_1f);
},updateFieldDisplay:function(_20){
if(dojo.byId(this.widgetId+"_display").value=="detail"){
x$("#"+this.widgetId+"_item_count").html(this.numDetailOptionsHtml);
if(_20||!xg.index.util.FormHelper.select(this._itemCount,dojo.byId(this.widgetId+"_item_count"))){
xg.index.util.FormHelper.select("4",dojo.byId(this.widgetId+"_item_count"));
}
x$(".excerptItem",this.form).show();
}else{
x$("#"+this.widgetId+"_item_count").html(this.numTitleOptionsHtml);
if(_20||!xg.index.util.FormHelper.select(this._itemCount,dojo.byId(this.widgetId+"_item_count"))){
xg.index.util.FormHelper.select("5",dojo.byId(this.widgetId+"_item_count"));
}
x$(".excerptItem",this.form).hide();
}
},toggleForumRelated:function(_21){
dojo.byId(this.widgetId+"_display").disabled=_21;
dojo.byId(this.widgetId+"_select").disabled=_21;
if(_21){
dojo.byId(this.widgetId+"_display").className="disabled";
dojo.byId(this.widgetId+"_select").className="disabled";
}else{
dojo.byId(this.widgetId+"_display").className="";
dojo.byId(this.widgetId+"_select").className="";
}
},hideForm:function(){
var _22=this.module.getElementsByTagName("a")[0];
xg.shared.EditUtil.hideModuleForm(this.form,this.formHeight,_22);
},save:function(_23){
dojo.event.browser.stopEvent(_23);
this._viewSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_view")).value;
this._displaySet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_display")).value;
this._topicSet=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_select")).value;
this._excerptLengthSet=x$("#"+this.widgetId+"_excerptLength").val();
this._itemCount=xg.index.util.FormHelper.selectedOption(dojo.byId(this.widgetId+"_item_count")).value;
this._newTopicUrl=x$(".xj_new_topic_link").attr("href");
this.hideForm();
dojo.io.bind({url:this._setValuesUrl,method:"post",content:{displaySet:this._displaySet,topicSet:this._topicSet,itemCount:this._itemCount,viewSet:this._viewSet,excerptLengthSet:this._excerptLengthSet},preventCache:true,mimetype:"text/javascript",encoding:"utf-8",load:dojo.lang.hitch(this,dojo.lang.hitch(this,function(_24,_25,_26){
dojo.lang.forEach(dojo.html.getElementsByClass("xg_module_body",this.module),function(_27){
dojo.dom.removeNode(_27);
});
var _28=dojo.html.getElementsByClass("xg_module_foot",this.module)[0];
if(_28){
dojo.dom.removeNode(_28);
}
dojo.lang.forEach(dojo.html.createNodesFromText(_25.moduleBodyAndFooterHtml),dojo.lang.hitch(this,function(_29){
dojo.dom.insertAtPosition(_29,this.module,"last");
}));
xg.shared.util.fixImagesInIE(this.module.getElementsByTagName("img"));
x$(".xj_new_topic_link").attr("href",this._newTopicUrl);
}))});
}});
}
